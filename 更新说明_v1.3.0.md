# 更新说明 - v1.3.0

## 📅 更新日期
2025年12月15日

## ✨ 新增功能

### 1. **样例显示增强** 
- ✅ 手工表和系统表样例从单行改为显示**前5条数据**
- ✅ 每条数据格式：`序号. 主键值1, 主键值2... = 数值`
- ✅ 样例区域可独立滚动（固定高度100px）
- ✅ 超过5条时显示总数提示（如"... 共38条数据"）
- ✅ 系统表额外显示透视信息（如"透视: 月份(12值)"）

### 2. **结果预览优化**
- ✅ Treeview显示行数从8行增加到**15行**
- ✅ 状态栏显示更新（"预览前15行 / 共XX行"）
- ✅ 样例区域使用Canvas+Scrollbar实现可滚动列表
- ✅ 整体布局更加紧凑，信息密度提升

### 3. **模板管理增强**
- ✅ 新增**🗑️ 删除模板**按钮
- ✅ 删除前弹出二次确认对话框（防止误删）
- ✅ 删除成功后自动刷新模板列表
- ✅ 删除后下拉框重置为"(选择模板)"

### 4. **滚动条UI统一优化**
- ✅ 创建通用滚动条工具模块 [ui/scroll_utils.py](ui/scroll_utils.py)
- ✅ 统一所有滚动容器的鼠标滚轮行为
  - 仅在鼠标进入区域时激活滚轮
  - 离开时自动解绑，避免联动滚动
- ✅ Combobox下拉框滚动事件隔离（使用`disable_combobox_scroll`）
- ✅ 支持跨平台（Windows/Linux/macOS）

## 🔧 技术改进

### 代码重构
- **新增文件**: [ui/scroll_utils.py](ui/scroll_utils.py) - 滚动条工具库
  - `disable_combobox_scroll()` - 禁用Combobox滚轮联动
  - `setup_mousewheel_scroll()` - Canvas滚轮配置
  - `create_scrollable_frame()` - 快速创建可滚动容器

### 修改文件
1. **[ui/result_preview.py](ui/result_preview.py)**
   - 样例区域重构：单Label → Canvas+ScrolledFrame（5条数据列表）
   - Treeview height: 8 → 15
   - 数据填充: `head(8)` → `head(15)`
   - `_update_sample_labels()` 完全重写，支持多行数据显示

2. **[ui/main_window.py](ui/main_window.py)**
   - 顶部模板区域增加删除按钮
   - 新增 `_delete_template()` 方法
   - 使用 `Messagebox.yesno()` 替代 `show_question()`

3. **[ui/config_panel.py](ui/config_panel.py)**
   - 移除本地 `disable_combobox_scroll()` 定义
   - 从 `scroll_utils` 导入通用函数
   - 滚动条绑定逻辑简化（使用 `setup_mousewheel_scroll()`）

## 📊 UI对比

### 样例显示（旧 vs 新）
```
【旧版】单行文本：
  手工表样例: 主键: 张三, 部门A | 数值: 数量

【新版】5条列表（可滚动）：
  1. 张三, 部门A = 100
  2. 李四, 部门B = 200
  3. 王五, 部门A = 150
  4. 赵六, 部门C = 300
  5. 孙七, 部门B = 250
  ... 共38条数据
```

### 结果预览（旧 vs 新）
```
【旧版】显示8行
【新版】显示15行 - 屏幕利用率提升87.5%
```

## 🎯 用户体验提升

1. **信息可见性**: 样例从1条增至5条，快速了解数据分布
2. **预览效率**: 结果预览从8行增至15行，减少滚动操作
3. **模板管理**: 支持删除无用模板，保持列表整洁
4. **滚动流畅**: 统一滚动行为，消除联动干扰

## 🐛 修复问题

- ✅ 修复滚动配置面板时Combobox下拉框联动滚动
- ✅ 修复样例标签未实时更新数据的问题
- ✅ 修复模板删除对话框参数错误

## 📝 兼容性说明

- **Python版本**: 3.9+
- **依赖库**: ttkbootstrap, pandas, openpyxl
- **操作系统**: Windows/macOS/Linux
- **向后兼容**: 完全兼容v1.2.0配置文件和模板

## 🚀 下一步计划

- [ ] 样例数据支持筛选条件预览
- [ ] 结果预览支持自定义显示行数
- [ ] 模板支持分组管理
- [ ] 滚动条视觉样式自定义

---

**版本**: v1.3.0  
**开发者**: GitHub Copilot  
**更新内容**: 样例显示、预览行数、模板管理、滚动条优化
