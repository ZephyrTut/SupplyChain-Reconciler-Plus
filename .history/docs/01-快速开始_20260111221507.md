# 🚀 快速开始指南

**5分钟上手供应链对账系统**

---

## 📋 前置条件

在开始之前，请确保：
- ✅ 已安装 Python 3.10+
- ✅ 已安装所有依赖（见 [安装配置](./02-安装配置.md)）
- ✅ 准备好要对账的两个Excel文件（手工表和系统表）

---

## 🎯 三步完成对账

### 步骤1: 导入文件

1. **启动应用**
   ```bash
   python main.py
   ```

2. **导入手工表**
   - 点击左侧「选择文件」按钮
   - 或直接拖拽Excel文件到卡片区域
   - 支持格式: `.xlsx`, `.xls`, `.xlsm`

3. **导入系统表**
   - 同样方式导入右侧系统表文件

4. **选择Sheet**（如有多个）
   - 文件导入后，下拉框会显示所有Sheet
   - 选择目标数据所在的Sheet

5. 点击「下一步」进入配置

![步骤1示意](./images/step1.png)

---

### 步骤2: 配置比对规则

#### 2.1 配置主键映射（必填）

主键用于匹配两表中的对应行：

```
手工表主键              系统表主键
[订单编号] ←→ [订单编号]
[物料编码] ←→ [物料编码]
```

- 点击「➕ 添加主键」可添加多个主键字段
- 支持复合主键（多字段组合）

#### 2.2 配置数值列映射（必填）

设置要比对的数量列：
```
手工数量列: [到货数量]
系统数量列: [执行数量]
```

#### 2.3 配置数据清洗（可选）

如需清洗数据（如去除后缀）：
```
列: [到货单号]
模式: [删除匹配]
正则: -\d+$
```

#### 2.4 配置筛选条件（可选）

过滤不需要的数据：
```
手工表: 状态 等于 已审核
系统表: 状态 包含于 [已完成,已发货]
```

#### 2.5 配置透视（可选）

**手工表透视**（出入库区分）:
```
透视列: [业务类型]
出库值: [发货, 退货]
入库值: [退仓]
```

**系统表透视**:
```
透视列: [订单状态]
```

#### 2.6 配置差值公式

默认公式: `手工数量 - 系统总计`

也可自定义:
```
手工数量 - (系统总计 - 已关闭)
```

---

### 步骤3: 执行对账

1. 点击「🚀 执行对账」按钮
2. 等待处理完成（显示加载动画）
3. 查看结果预览
4. 点击「📥 导出Excel」保存结果

---

## 📊 结果解读

| 状态 | 符号 | 颜色 | 说明 |
|------|------|------|------|
| 一致 | ✓ | 浅绿 | 数量完全匹配 |
| 差异 | ↕ | 浅黄 | 数量存在差异 |
| 手工缺失 | ✗ | 浅红 | 系统有但手工无 |
| 系统缺失 | ✗ | 浅红 | 手工有但系统无 |

---

## 💡 快速技巧

1. **保存模板**: 配置完成后点击「💾 保存模板」，下次可直接加载
2. **预览数据**: 右侧面板实时显示数据样例和预览结果
3. **导出预览**: 可单独导出手工表/系统表的预处理数据

---

## ▶️ 下一步

- 详细了解各功能: [数据导入](./03-数据导入.md)
- 遇到问题: [常见问题FAQ](./19-常见问题.md)
