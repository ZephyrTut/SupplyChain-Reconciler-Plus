# SupplyChain-Reconciler-Plus

**供应链智能对账系统** - Python桌面应用 (PyQt6)  
**当前版本**: v1.4.0 | **更新日期**: 2025年12月16日

---

## 📖 快速导航

- [🚀 快速开始](#快速开始) - 5分钟上手
- [✨ 核心功能](#核心功能) - 功能概览
- [📚 完整文档](PROJECT_OVERVIEW.md) - 详细使用指南
- [🐛 问题反馈](https://github.com/yourusername/SupplyChain-Reconciler-Plus/issues) - 提交Bug

---

## 🎯 项目简介

SupplyChain-Reconciler-Plus 是一个**零代码**的供应链对账工具，专为财务和供应链部门设计，用于快速比对手工表与系统表的数据差异。

### 适用场景
- ✅ 库存对账（盘点 vs ERP）
- ✅ 订单核对（手工 vs OMS）
- ✅ 财务对账（账目 vs 系统）
- ✅ 任何双表数据比对场景

### 核心优势
- 🎨 **现代界面** - PyQt6 + Material Design
- 🔑 **复合主键** - 支持多字段组合
- 📊 **透视分析** - 自动展开系统表透视列
- 🧮 **自定义公式** - 灵活配置差值计算
- 💾 **模板管理** - 保存常用配置
- 🌈 **彩色导出** - 结果自动标色
- 📁 **多格式支持** - .xlsx/.xls/.xlsm

---

## 🚀 快速开始

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

**主要依赖**:
- PyQt6 - 现代化GUI框架
- qt-material - Material Design主题（可选）
- pandas - 数据处理
- openpyxl, xlrd - Excel读写

### 2. 启动应用

```bash
python main.py
```

### 3. 三步完成对账

#### 步骤1: 导入文件
- 点击"选择手工表文件"导入Excel
- 点击"选择系统表文件"导入Excel
- 支持拖拽上传（PyQt6原生支持）
- 支持 .xlsx, .xls, .xlsm 格式

#### 步骤2: 配置规则
```
主键映射: 订单编号 ←→ 订单编号
数值列: [手工数量] vs [系统数量]
透视列: [订单状态] (可选)
差值公式: M - S (手工 - 系统)
```

#### 步骤3: 执行对账
- 点击"🚀 执行对账"
- 查看结果预览
- 点击"📥 导出Excel"保存结果

---

## ✨ 核心功能

### 双表对账
- **手工表**: 人工录入或盘点的数据
- **系统表**: ERP/WMS/OMS导出的数据
- **结果**: ✓一致 / ↕差异 / ✗缺失

### 复合主键
支持多字段组合主键：
```
订单编号 + 物料编码
客户ID + 产品SKU
仓库 + 批次号
```

### 透视列处理
自动展开系统表透视数据：
```
订单号 | 状态   | 数量          订单号 | 已完成 | 处理中 | 总计
A001  | 已完成 | 100    →     A001  | 100   | 50    | 150
A001  | 处理中 | 50
```

### 动态差值公式
使用字母代号自定义：
```python
M - S              # 基本差值
M - (S - A)       # 排除透视列A
M - (A + B)       # 只对比A和B
```

### 配置模板
- 💾 保存常用配置
- 📂 快速加载模板
- 🗑️ 删除无用模板

### 彩色导出
```
✓ 一致 → 浅绿色背景
↕ 差异 → 浅黄色背景
✗ 缺失 → 浅红色背景
```

---

## 📦 环境要求

- **Python**: 3.10+
- **操作系统**: Windows / macOS / Linux
- **内存**: 2GB+
- **磁盘**: 50MB

---

## 📚 详细文档

完整使用指南请查看: **[PROJECT_OVERVIEW.md](PROJECT_OVERVIEW.md)**

文档内容包括：
- 📖 详细使用教程
- 🏗️ 项目架构说明
- 🔧 开发者指南
- 🐛 常见问题排查
- 📊 性能优化建议
- 📝 版本更新历史

---

## 🛠️ 可选依赖

增强功能（推荐安装）：

```bash
# 文件拖拽支持
pip install tkinterdnd2

# 旧版Excel支持 (.xls)
pip install xlrd

# Windows活动Excel检测
pip install pywin32
```

---

## 📝 使用示例

### 示例1: 库存对账

**场景**: 盘点数据 vs ERP库存

```
手工表 (盘点表.xlsx):
料号   | 盘点数量
SKU001 | 100
SKU002 | 200

系统表 (ERP导出.xlsx):
料号   | 系统数量
SKU001 | 95
SKU002 | 200

对账结果:
料号   | 盘点数量 | 系统数量 | 差值 | 状态
SKU001 | 100     | 95      | 5   | ↕
SKU002 | 200     | 200     | 0   | ✓
```

### 示例2: 订单对账（含透视）

**场景**: 手工统计 vs 订单系统（按状态分组）

```
手工表:
订单号 | 手工总数
A001  | 150

系统表（透视前）:
订单号 | 状态   | 数量
A001  | 已完成 | 100
A001  | 处理中 | 50

系统表（透视后）:
订单号 | 已完成 | 处理中 | 系统总计
A001  | 100   | 50    | 150

对账结果:
订单号 | 手工总数 | 已完成 | 处理中 | 系统总计 | 差值 | 状态
A001  | 150     | 100   | 50    | 150     | 0   | ✓
```

---

## 🎓 学习资源

### 新手教程
1. [安装与配置](PROJECT_OVERVIEW.md#安装与运行)
2. [快速上手](PROJECT_OVERVIEW.md#使用指南)
3. [公式编写](PROJECT_OVERVIEW.md#动态差值公式)

### 进阶技巧
1. [模板管理](PROJECT_OVERVIEW.md#配置模板使用)
2. [透视处理](PROJECT_OVERVIEW.md#透视列pivot支持)
3. [性能优化](PROJECT_OVERVIEW.md#性能指标)

### 开发者
1. [项目架构](PROJECT_OVERVIEW.md#架构设计)
2. [代码规范](PROJECT_OVERVIEW.md#代码规范)
3. [测试指南](PROJECT_OVERVIEW.md#测试)

---

## 🤝 贡献指南

欢迎提交Issue和Pull Request！

1. Fork 本仓库
2. 创建特性分支 (`git checkout -b feature/AmazingFeature`)
3. 提交更改 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 开启 Pull Request

---

## 📊 版本历史

### v1.3.0 (2025-12-15) - 最新版本
- ✨ 样例显示增强（5条数据）
- ✨ 结果预览优化（15行显示）
- ✨ 模板删除功能
- ✨ 滚动条UI统一

### v1.2.0 (2025-12-14)
- ✨ 数据样例预览
- ✨ 活动Excel检测
- ✨ 拖拽导入支持
- 🐛 Bug修复（滚动联动、预览更新）

**详细更新日志**: [PROJECT_OVERVIEW.md - 版本历史](PROJECT_OVERVIEW.md#版本历史)

---

## 📄 许可证

MIT License - 详见 [LICENSE](LICENSE) 文件

---

## 💬 联系方式

- **项目主页**: https://github.com/yourusername/SupplyChain-Reconciler-Plus
- **问题反馈**: [GitHub Issues](https://github.com/yourusername/SupplyChain-Reconciler-Plus/issues)
- **功能建议**: 欢迎提交 Pull Request

---

## ⭐ Star History

如果这个项目对你有帮助，请给一个 ⭐ Star！

---

**快速开始**: `python main.py`  
**完整文档**: [PROJECT_OVERVIEW.md](PROJECT_OVERVIEW.md)

