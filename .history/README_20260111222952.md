# SupplyChain-Reconciler-Plus

**供应链智能对账系统** - Python桌面应用 (PyQt6)  
**当前版本**: v1.4.3 | **更新日期**: 2026年1月11日

---

##  快速导航

- [ 快速开始](#快速开始) - 5分钟上手
- [ 核心功能](#核心功能) - 功能概览
- [ 完整文档](PROJECT_OVERVIEW.md) - 详细使用指南

---

##  项目简介

SupplyChain-Reconciler-Plus 是一个**零代码**的供应链对账工具，专为财务和供应链部门设计，用于快速比对手工表与系统表的数据差异。

### 适用场景
-  库存对账（盘点 vs ERP）
-  订单核对（手工 vs OMS）
-  财务对账（账目 vs 系统）
-  ASN送货单对账
-  任何双表数据比对场景

### 核心优势
-  **现代界面** - PyQt6 + Material Design
-  **复合主键** - 支持多字段组合
-  **双向透视** - 手工表/系统表均支持透视聚合
-  **出入库区分** - 手工表透视支持出库/入库方向
-  **数据清洗** - 正则表达式批量清洗
-  **灵活筛选** - 多种筛选操作符
-  **自定义公式** - 灵活配置差值计算
-  **模板管理** - 保存常用配置
-  **彩色导出** - 结果自动标色
-  **多格式支持** - .xlsx/.xls/.xlsm

---

##  快速开始

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

**主要依赖**:
- PyQt6 - 现代化GUI框架
- qt-material - Material Design主题
- pandas - 数据处理
- openpyxl, xlrd - Excel读写

### 2. 启动应用

```bash
python main.py
```

### 3. 三步完成对账

#### 步骤1: 导入文件
- 点击"选择文件"或直接拖拽Excel文件
- 支持 .xlsx/.xls/.xlsm 格式
- 多Sheet文件可选择目标Sheet

#### 步骤2: 配置规则
- **主键映射**: 设置手工表与系统表的对应列
- **数值列**: 设置要比对的数量列
- **数据清洗**（可选）: 正则表达式清洗数据
- **筛选条件**（可选）: 过滤不需要的数据
- **透视配置**（可选）: 设置聚合规则
- **差值公式**: 配置计算方式

#### 步骤3: 执行导出
- 点击" 执行对账"
- 查看结果预览
- 导出带颜色的Excel报告

---

##  核心功能

### 数据清洗
支持使用正则表达式清洗列数据：
- **删除匹配**: 删除符合正则的内容
- **保留匹配**: 只保留符合正则的内容
- **替换为**: 将匹配内容替换为指定值

### 手工表透视（出入库）
```
透视列: 业务类型
出库值: [发货, 退货]
入库值: [退仓]
结果: 手工数量 = Σ出库 - Σ入库
```

### 系统表透视
```
原始数据:
订单号 | 状态   | 数量
A001  | 已完成 | 100
A001  | 处理中 | 50

透视后:
订单号 | 已完成 | 处理中 | 系统总计
A001  | 100   | 50    | 150
```

### 筛选操作符
| 操作符 | 说明 |
|-------|------|
| 等于 | 精确匹配 |
| 不等于 | 排除值 |
| 包含 | 部分匹配（支持多值，逗号分隔）|
| 不包含 | 排除部分匹配 |
| 包含于 | 值在列表中（多选）|
| 大于/小于 | 数值比较 |

### 自定义公式
```
手工数量 - 系统总计           # 基本差值
手工数量 - (系统总计 - 已关闭) # 排除某透视列
手工数量 - (已完成 + 处理中)   # 只对比指定列
```

---

##  比对结果说明

| 状态 | 符号 | 颜色 | 说明 |
|-----|------|------|------|
| 一致 |  | 浅绿 | 手工与系统数量相等 |
| 差异 |  | 浅黄 | 数量存在差异 |
| 缺失 |  | 浅红 | 单方存在数据 |

---

##  技术栈

| 组件 | 技术 |
|-----|------|
| GUI | PyQt6 + qt-material |
| 数据处理 | pandas |
| Excel读写 | openpyxl + xlrd |
| 主题 | Material Design (浅色) |

---

##  项目结构

```
SupplyChain-Reconciler-Plus/
 main.py              # 启动入口
 config/              # 配置常量
 core/                # 核心逻辑
    compare_engine.py   # 比对引擎
    export_engine.py    # 导出引擎
 ui/                  # 界面模块
    qt_main_window.py   # 主窗口
    qt_config_panel.py  # 配置面板
    qt_result_preview.py# 结果预览
    qt_dialogs.py       # 对话框组件
 utils/               # 工具模块
 tests/               # 测试模块
```

---

##  📚 文档

### 快速查看

| 文档 | 说明 |
|------|------|
| [PROJECT_OVERVIEW.md](PROJECT_OVERVIEW.md) | 完整项目文档 |
| [CHANGELOG.md](CHANGELOG.md) | 版本历史与发布说明 |
| [ARCHITECTURE.md](ARCHITECTURE.md) | 系统架构与设计 |
| [docs/](docs/) | 20份详细功能文档 |

### 学习路径

**👤 普通用户** → 按此顺序阅读
1. [README.md](README.md) (本文件)
2. [docs/01-快速开始.md](docs/01-快速开始.md)
3. [PROJECT_OVERVIEW.md](PROJECT_OVERVIEW.md)
4. [docs/](docs/) 中的相关功能文档

**👨‍💻 开发者** → 按此顺序阅读
1. [README.md](README.md)
2. [ARCHITECTURE.md](ARCHITECTURE.md)
3. [AGENT.md](AGENT.md) - **强制性**
4. [docs/14-核心引擎API.md](docs/14-核心引擎API.md)
5. [docs/15-UI组件API.md](docs/15-UI组件API.md)
6. [.github/copilot-instructions.md](.github/copilot-instructions.md)

---

##  许可证

MIT License

---

**最后更新**: 2026年1月11日
