# ğŸ“¥ ç»“æœå¯¼å‡º

**Excelå¯¼å‡ºä¸é¢œè‰²æ ‡è®°è¯¦è§£**

---

## ğŸ“‹ åŠŸèƒ½æ¦‚è¿°

å¯¹è´¦å®Œæˆåï¼Œå¯å°†ç»“æœå¯¼å‡ºä¸ºå¸¦é¢œè‰²æ ‡è®°çš„Excelæ–‡ä»¶ï¼Œæ–¹ä¾¿æŸ¥çœ‹å’Œåˆ†äº«ã€‚

### å¯¼å‡ºç‰¹æ€§

- âœ… å¤šSheetç»“æ„
- âœ… è¡Œé¢œè‰²æ ‡è®°
- âœ… è‡ªåŠ¨åˆ—å®½
- âœ… ç»Ÿè®¡ä¿¡æ¯

---

## ğŸ¨ å¯¼å‡ºç•Œé¢

### æ­¥éª¤3: ç»“æœä¸å¯¼å‡º

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ğŸ“Š å¯¹è´¦ç»“æœ                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ __KEY__  â”‚ å·²å®Œæˆ â”‚ ç³»ç»Ÿæ€»è®¡ â”‚ æ‰‹å·¥æ•°é‡ â”‚ å·®å€¼ â”‚ çŠ¶æ€ â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ A001_M01 â”‚   80   â”‚    80   â”‚    80   â”‚   0  â”‚  âœ“  â”‚   â”‚
â”‚  â”‚ A001_M02 â”‚   50   â”‚    50   â”‚    55   â”‚   5  â”‚  â†•  â”‚   â”‚
â”‚  â”‚ A002_M01 â”‚   -    â”‚    -    â”‚   100   â”‚ 100  â”‚  âœ—  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚  ç»Ÿè®¡: ä¸€è‡´ 45 | å·®å¼‚ 12 | ç¼ºå¤± 3 | å…± 60 è¡Œ                 â”‚
â”‚                                                             â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚              â”‚   ğŸ“¥ å¯¼å‡ºExcel       â”‚                        â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ å¯¼å‡ºæ–‡ä»¶ç»“æ„

### æ–‡ä»¶å‘½å

```
å¯¹è´¦ç»“æœ_YYYYMMDD_HHMMSS.xlsx

ç¤ºä¾‹: å¯¹è´¦ç»“æœ_20260111_143052.xlsx
```

### Sheetç»“æ„

| Sheetå | å†…å®¹ | è¯´æ˜ |
|---------|------|------|
| ğŸ“‹ å®Œæ•´ç»“æœ | æ‰€æœ‰æ•°æ® | åŒ…å«ä¸€è‡´ã€å·®å¼‚ã€ç¼ºå¤± |
| ğŸ“Œ å·®å¼‚æ•°æ® | ä»…å·®å¼‚å’Œç¼ºå¤± | ä¾¿äºå¿«é€ŸæŸ¥çœ‹é—®é¢˜ |
| â„¹ï¸ è¯´æ˜ | å…ƒæ•°æ®ä¿¡æ¯ | é…ç½®ã€ç»Ÿè®¡ã€å›¾ä¾‹ |

---

## ğŸ¨ é¢œè‰²æ ‡è®°

### è¡Œé¢œè‰²è§„åˆ™

| çŠ¶æ€ | é¢œè‰² | RGBå€¼ | è¯´æ˜ |
|------|------|-------|------|
| âœ“ ä¸€è‡´ | æµ…ç»¿è‰² | #D1FAE5 | æ•°é‡å®Œå…¨åŒ¹é… |
| â†• å·®å¼‚(æ­£) | æµ…é»„ç»¿ | #D9F99D | æ‰‹å·¥ > ç³»ç»Ÿ |
| â†• å·®å¼‚(è´Ÿ) | æµ…è“è‰² | #BFDBFE | æ‰‹å·¥ < ç³»ç»Ÿ |
| âœ— ç¼ºå¤± | æµ…çº¢è‰² | #FECACA | å•æ–¹å­˜åœ¨ |

### è¡¨å¤´æ ·å¼

- èƒŒæ™¯è‰²: æµ…ç°è‰² (#E2E8F0)
- å­—ä½“: åŠ ç²—
- å¯¹é½: å±…ä¸­

---

## ğŸ“Š åˆ—é¡ºåº

å¯¼å‡ºçš„åˆ—æŒ‰ä»¥ä¸‹é¡ºåºæ’åˆ—ï¼š

| åºå· | åˆ—å | è¯´æ˜ |
|------|------|------|
| 1 | __KEY__ | å¤åˆä¸»é”® |
| 2~N | é€è§†åˆ— | æŒ‰å­—æ¯æ’åº |
| N+1 | ç³»ç»Ÿæ€»è®¡ | ç³»ç»Ÿè¡¨æ€»è®¡ |
| N+2 | æ‰‹å·¥æ•°é‡ | æ‰‹å·¥è¡¨æ•°é‡ |
| N+3 | å·®å€¼ | è®¡ç®—çš„å·®å€¼ |
| N+4 | æ¯”å¯¹çŠ¶æ€ | çŠ¶æ€ç¬¦å· |

### ç¤ºä¾‹

```
| __KEY__ | å·²å®Œæˆ | å¤„ç†ä¸­ | ç³»ç»Ÿæ€»è®¡ | æ‰‹å·¥æ•°é‡ | å·®å€¼ | æ¯”å¯¹çŠ¶æ€ |
```

---

## ğŸ“‹ è¯´æ˜Sheetå†…å®¹

### åŸºæœ¬ä¿¡æ¯

```
å¯¹è´¦æŠ¥å‘Šè¯´æ˜
=============

å¯¼å‡ºæ—¶é—´: 2026-01-11 14:30:52

æ–‡ä»¶ä¿¡æ¯:
- æ‰‹å·¥è¡¨: è®¢å•æ•°æ®.xlsx (Sheet1)
- ç³»ç»Ÿè¡¨: ç³»ç»Ÿå¯¼å‡º.xlsx (æ‰§è¡ŒæŠ¥è¡¨)

ä¸»é”®é…ç½®:
- è®¢å•ç¼–å· â†” è®¢å•ç¼–å·
- ç‰©æ–™ç¼–ç  â†” é›¶ä»¶å·
```

### ç»Ÿè®¡ä¿¡æ¯

```
ç»Ÿè®¡ç»“æœ:
- æ€»è¡Œæ•°: 60
- ä¸€è‡´: 45 (75.0%)
- å·®å¼‚: 12 (20.0%)
- ç¼ºå¤±: 3 (5.0%)
```

### é¢œè‰²å›¾ä¾‹

```
é¢œè‰²è¯´æ˜:
- æµ…ç»¿è‰²: ä¸€è‡´ (å·®å€¼=0)
- æµ…é»„è‰²: å·®å¼‚ (æ‰‹å·¥>ç³»ç»Ÿ)
- æµ…è“è‰²: å·®å¼‚ (æ‰‹å·¥<ç³»ç»Ÿ)
- æµ…çº¢è‰²: ç¼ºå¤± (å•æ–¹å­˜åœ¨)
```

### é…ç½®ä¿¡æ¯

```
ä½¿ç”¨çš„å…¬å¼:
æ‰‹å·¥æ•°é‡ - ç³»ç»Ÿæ€»è®¡

ç­›é€‰æ¡ä»¶:
- æ‰‹å·¥è¡¨: çŠ¶æ€=å·²å®¡æ ¸
- ç³»ç»Ÿè¡¨: çŠ¶æ€ åŒ…å«äº [å·²å®Œæˆ,å·²å‘è´§]

é€è§†é…ç½®:
- ç³»ç»Ÿè¡¨é€è§†åˆ—: è®¢å•çŠ¶æ€
- é€è§†å€¼: å·²å®Œæˆ, å¤„ç†ä¸­, å¾…å®¡æ ¸
```

---

## ğŸ“¥ å¯¼å‡ºæ­¥éª¤

### æ­¥éª¤1: æ‰§è¡Œå¯¹è´¦

ç¡®ä¿å·²å®Œæˆå¯¹è´¦ï¼Œç»“æœé¢„è§ˆæ˜¾ç¤ºæ•°æ®ã€‚

### æ­¥éª¤2: ç‚¹å‡»å¯¼å‡º

ç‚¹å‡»ã€ŒğŸ“¥ å¯¼å‡ºExcelã€æŒ‰é’®ã€‚

### æ­¥éª¤3: é€‰æ‹©ä¿å­˜ä½ç½®

1. å¼¹å‡ºæ–‡ä»¶ä¿å­˜å¯¹è¯æ¡†
2. é€‰æ‹©ä¿å­˜ç›®å½•
3. å¯ä¿®æ”¹æ–‡ä»¶å
4. ç‚¹å‡»ã€Œä¿å­˜ã€

### æ­¥éª¤4: å®Œæˆ

- æ˜¾ç¤ºå¯¼å‡ºæˆåŠŸæç¤º
- å¯é€‰æ‹©ç›´æ¥æ‰“å¼€æ–‡ä»¶

---

## ğŸ”§ è‡ªåŠ¨åˆ—å®½

ç³»ç»Ÿä¼šæ ¹æ®å†…å®¹è‡ªåŠ¨è°ƒæ•´åˆ—å®½ï¼š

| åˆ—ç±»å‹ | å®½åº¦è§„åˆ™ |
|--------|---------|
| __KEY__ | æœ€å°15å­—ç¬¦ï¼Œæœ€å¤§50å­—ç¬¦ |
| æ•°å€¼åˆ— | æœ€å°10å­—ç¬¦ |
| çŠ¶æ€åˆ— | å›ºå®š12å­—ç¬¦ |
| å…¶ä»– | æ ¹æ®å†…å®¹è‡ªé€‚åº” |

---

## ğŸ“Š å¯¼å‡ºé¢„å¤„ç†é¢„è§ˆ

### åŠŸèƒ½

åœ¨æ‰§è¡Œå¯¹è´¦å‰ï¼Œå¯å•ç‹¬å¯¼å‡ºé¢„å¤„ç†åçš„æ•°æ®é¢„è§ˆï¼š

1. **æ‰‹å·¥è¡¨é¢„å¤„ç†é¢„è§ˆ**: æ˜¾ç¤ºæ¸…æ´—ã€ç­›é€‰ã€é€è§†åçš„æ‰‹å·¥è¡¨
2. **ç³»ç»Ÿè¡¨é¢„å¤„ç†é¢„è§ˆ**: æ˜¾ç¤ºæ¸…æ´—ã€ç­›é€‰ã€é€è§†åçš„ç³»ç»Ÿè¡¨

### ç”¨é€”

- æ£€æŸ¥æ•°æ®æ¸…æ´—æ•ˆæœ
- éªŒè¯ç­›é€‰æ¡ä»¶
- ç¡®è®¤é€è§†è®¡ç®—

### æ“ä½œ

åœ¨æ­¥éª¤2çš„æ ·ä¾‹åŒºåŸŸï¼š
- ç‚¹å‡»ã€Œå¯¼å‡ºæ‰‹å·¥è¡¨é¢„å¤„ç†é¢„è§ˆã€
- ç‚¹å‡»ã€Œå¯¼å‡ºç³»ç»Ÿè¡¨é¢„å¤„ç†é¢„è§ˆã€

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. æ–‡ä»¶è¢«å ç”¨

å¦‚æœç›®æ ‡æ–‡ä»¶å·²æ‰“å¼€ï¼Œå¯¼å‡ºä¼šå¤±è´¥ã€‚

**è§£å†³**: å…³é—­Excelåé‡è¯•ã€‚

### 2. ç£ç›˜ç©ºé—´

ç¡®ä¿ç›®æ ‡ç£ç›˜æœ‰è¶³å¤Ÿç©ºé—´ã€‚

### 3. æ–‡ä»¶åé™åˆ¶

é¿å…ä½¿ç”¨ç‰¹æ®Šå­—ç¬¦ï¼š`\ / : * ? " < > |`

### 4. å¤§æ–‡ä»¶æ€§èƒ½

æ•°æ®é‡è¶…è¿‡10ä¸‡è¡Œæ—¶ï¼š
- å¯¼å‡ºæ—¶é—´è¾ƒé•¿
- å»ºè®®åˆ†æ‰¹å¤„ç†

---

## ğŸ’» æŠ€æœ¯å®ç°

### æ ¸å¿ƒå‡½æ•°

```python
from core.export_engine import ExportEngine

ExportEngine.export_results(
    out_path="å¯¹è´¦ç»“æœ.xlsx",
    result_df=result_dataframe,
    pivot_values=["å·²å®Œæˆ", "å¤„ç†ä¸­"],
    config_info={
        "manual_file": "æ‰‹å·¥è¡¨.xlsx",
        "system_file": "ç³»ç»Ÿè¡¨.xlsx",
        "key_mappings": [...],
        "formula": "æ‰‹å·¥æ•°é‡ - ç³»ç»Ÿæ€»è®¡"
    }
)
```

### é¢œè‰²åº”ç”¨

```python
from openpyxl.styles import PatternFill

# å®šä¹‰é¢œè‰²
COLORS = {
    "match": "FFD1FAE5",     # ä¸€è‡´-ç»¿
    "diff_pos": "FFD9F99D",  # å·®å¼‚-é»„
    "diff_neg": "FFBFDBFE",  # å·®å¼‚-è“
    "missing": "FFFECACA",   # ç¼ºå¤±-çº¢
}

# åº”ç”¨å¡«å……
fill = PatternFill(fill_type="solid", start_color=color)
cell.fill = fill
```

### ç›¸å…³æ–‡ä»¶

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `core/export_engine.py` | å¯¼å‡ºå¼•æ“ |
| `config/settings.py` | é¢œè‰²é…ç½® |

---

## â–¶ï¸ ä¸‹ä¸€æ­¥

äº†è§£ç•Œé¢è¯¦æƒ…ï¼ŒæŸ¥çœ‹ [ä¸»çª—å£ç•Œé¢](./10-ä¸»çª—å£ç•Œé¢.md)ã€‚
