# ❓ 常见问题

**FAQ与问题排查指南**

---

## 📋 目录

- [文件相关问题](#文件相关问题)
- [配置相关问题](#配置相关问题)
- [对账相关问题](#对账相关问题)
- [导出相关问题](#导出相关问题)
- [性能相关问题](#性能相关问题)
- [界面相关问题](#界面相关问题)

---

## 📁 文件相关问题

### Q: 无法打开Excel文件？

**可能原因**:
1. 文件被Excel程序占用
2. 文件格式不支持
3. 文件损坏

**解决方案**:
```
1. 关闭Excel中打开的文件
2. 确认文件格式为 .xlsx/.xls/.xlsm
3. 尝试用Excel打开文件确认是否损坏
```

---

### Q: 提示"文件被占用"？

**原因**: 文件正在Excel或其他程序中打开

**解决方案**:
```
1. 关闭Excel中的文件
2. 检查任务管理器是否有残留的Excel进程
3. 如果是Windows，可以重启资源管理器
```

---

### Q: 导入后列名显示为"Unnamed"？

**原因**: Excel文件表头行设置错误

**解决方案**:
```
1. 检查Excel文件的第一行是否为表头
2. 如有空白行或合并单元格，手动调整
3. 确保每列都有列名
```

---

### Q: 不支持的文件格式？

**支持的格式**:
- .xlsx (Excel 2007+)
- .xls (Excel 2003)
- .xlsm (含宏的工作簿)

**不支持**:
- .csv（请先用Excel转换为xlsx）
- .ods（LibreOffice格式）
- .numbers（Apple格式）

---

## ⚙️ 配置相关问题

### Q: 主键匹配不上？

**可能原因**:
1. 列名选择错误
2. 数据格式不一致
3. 有多余空格

**排查步骤**:
```
1. 检查手工表和系统表的主键列是否对应
2. 查看样例数据，确认数据格式一致
3. 使用数据清洗删除首尾空格
```

**示例**:
```
手工表: "A001 " (末尾有空格)
系统表: "A001" (无空格)
结果: 匹配失败

解决: 添加清洗规则删除首尾空格
```

---

### Q: 筛选条件不生效？

**排查步骤**:
```
1. 检查列名是否正确
2. 检查操作符是否合适
3. 检查筛选值的格式
```

**常见问题**:
```
问题: 筛选"状态=已完成"不生效
原因: 数据中是"已完成 "(末尾空格)
解决: 使用"包含"操作符代替"等于"
```

---

### Q: "包含于"筛选如何使用？

**格式**: 多个值用英文逗号分隔

**示例**:
```
列: 状态
操作符: 包含于
值: 已完成,已发货,处理中

效果: 只保留状态为上述三个值的行
```

---

### Q: 透视配置后数据异常？

**排查**:
```
1. 检查透视列的值是否正确识别
2. 确认出库/入库值没有重复
3. 查看预处理预览确认透视结果
```

**使用预处理预览**:
```
1. 完成透视配置
2. 点击"导出手工表预处理预览"
3. 检查透视计算是否正确
```

---

## 🔄 对账相关问题

### Q: 差值计算结果不正确？

**排查步骤**:
```
1. 检查差值公式是否正确
2. 确认变量名与实际列名一致
3. 查看透视值是否完整
```

**公式调试**:
```
公式: 手工数量 - (系统总计 - 已关闭)

检查:
- "已关闭"列是否存在于透视结果中
- 列名是否有空格或特殊字符
```

---

### Q: 结果全部显示"缺失"？

**可能原因**:
1. 主键完全不匹配
2. 筛选条件过滤了所有数据

**排查**:
```
1. 检查主键映射是否正确
2. 暂时移除所有筛选条件重新对账
3. 查看样例数据确认数据格式
```

---

### Q: 为什么有些行显示"仅手工存在"？

**原因**: 该主键在系统表中不存在

**可能情况**:
- 系统数据尚未录入
- 主键数据格式不一致
- 被筛选条件过滤

---

### Q: 数值列显示NaN？

**原因**: 数据中包含非数值内容

**解决**:
```
1. 检查Excel中该列是否有文本
2. 使用数据清洗删除非数字字符
3. 确保列中没有公式错误
```

---

## 📥 导出相关问题

### Q: 导出失败"权限被拒绝"？

**原因**: 导出路径无写入权限或文件已打开

**解决**:
```
1. 选择其他保存路径（如桌面）
2. 关闭已打开的同名文件
3. 以管理员身份运行程序
```

---

### Q: 导出的Excel颜色不显示？

**可能原因**:
1. 使用的Excel版本过旧
2. 使用WPS/LibreOffice打开

**建议**: 使用Microsoft Excel 2016+打开

---

### Q: 导出文件过大？

**原因**: 数据量大或透视列多

**优化**:
```
1. 使用筛选减少数据量
2. 减少不必要的透视列
3. 分批导出（按日期、类别等）
```

---

## ⚡ 性能相关问题

### Q: 处理大文件时很慢？

**预期性能**:
| 数据量 | 预计耗时 |
|--------|---------|
| < 1000行 | < 1秒 |
| 1-10000行 | 1-5秒 |
| 1-10万行 | 5-30秒 |

**优化建议**:
```
1. 使用筛选减少数据量
2. 关闭不必要的后台程序
3. 超大数据建议分批处理
```

---

### Q: 程序卡死无响应？

**可能原因**:
1. 数据量过大
2. 内存不足

**解决**:
```
1. 等待处理完成（有加载动画）
2. 重启程序
3. 减少数据量重试
```

---

### Q: 内存占用过高？

**原因**: 大数据集+透视操作

**优化**:
```
1. 关闭其他程序
2. 分批处理数据
3. 处理完成后关闭程序释放内存
```

---

## 🖥️ 界面相关问题

### Q: 界面显示模糊/缩放异常？

**Windows解决方案**:
```
1. 右键程序图标 → 属性
2. 兼容性 → 更改高DPI设置
3. 勾选"替代高DPI缩放行为"
4. 选择"应用程序"
```

---

### Q: 下拉框选项太多滚动困难？

**说明**: 下拉框已禁用滚轮，防止误操作

**使用方式**:
```
1. 点击下拉框展开
2. 使用键盘上下键选择
3. 或直接输入筛选
```

---

### Q: 折叠区域无法展开？

**解决**: 点击区域标题左侧的箭头符号

```
▶ 点击展开
▼ 点击折叠
```

---

### Q: 配置面板内容显示不全？

**解决**:
```
1. 最大化窗口
2. 使用滚动条查看
3. 折叠不需要的区域
```

---

## 🔧 其他问题

### Q: 模板无法加载？

**可能原因**:
1. 模板文件损坏
2. 列名与当前文件不匹配

**解决**:
```
1. 删除问题模板重新创建
2. 手动调整不匹配的列名
```

---

### Q: 如何重置所有配置？

**方法**:
```
1. 删除配置文件夹重启程序

Windows:
删除 %APPDATA%\SupplyChain-Reconciler-Plus\

macOS/Linux:
删除 ~/.config/SupplyChain-Reconciler-Plus/
```

---

### Q: 如何查看程序版本？

**方法**: 查看窗口标题栏

```
SupplyChain-Reconciler-Plus v1.4.3
```

---

## 📞 获取帮助

### 问题反馈

如果以上方案无法解决您的问题：

1. 记录详细的操作步骤
2. 截图错误信息
3. 提供数据样例（脱敏处理）
4. 通过GitHub Issues反馈

### 有用信息

反馈时请提供：
- 程序版本
- 操作系统
- 错误信息截图
- 复现步骤

---

## ▶️ 返回

- [快速开始](./01-快速开始.md)
- [文档首页](./README.md)
